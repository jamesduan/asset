<!DOCTYPE html>
<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>每日事故汇总</title>
		<style>
			/*公用样式 */
			*{
				margin:0;
				-webkit-box-sizing: border-box;
				-moz-box-sizing: border-box;
				box-sizing: border-box;
                font-family: 'Microsoft YaHei',Arial,SimSun,tahoma,sans-serif;
				font-size:12px;
				color:#333;
			}
            body{ min-width:600px;width:auto !important; width:600px;}

			table{
				border-bottom: 1px solid #13B890;
				border-collapse: collapse !important;
				border-radius: 1px;
				border-spacing: 0;
				table-layout:fixed;
			}
			.h3{font-weight:bold;font-size:16px;font-family: 'Microsoft YaHei'; color:#fff;line-height:30px; padding-left:10px;}
			table td,table th{
				font-size:14px;color:#333;
                font-family:'Microsoft YaHei';
                vertical-align:top;
                padding:8px;
                line-height:20px;
                border:1px solid #13B890;
			}
			table th,table th div{ font-size:14px;font-family: 'Microsoft YaHei'; color:#fff;}
			.td-first{
				width:90px;
				background-color:#E8FAF8;
				color:#000;
				font-size:16px;
				text-align: center;
				vertical-align: middle;
			}
			/*table*/
			.table2 .h3{ background-color:#0BC799;}
            .table3 .h3{ background-color:#fc832b;}
            .table3 {
                border-bottom: 1px solid #fc832b;
            }
            .table3 td, th{
                border:1px solid #fc832b;
            }
            .table1 .h3{ background-color:#ff5126;}
            .table1 {
                border-bottom: 1px solid #ff5126;
            }
            .table1 td, th{
                border:1px solid #ff5126;
            }
		</style>
	</head>
	<body>
		<div class="table2">
			<div class="h3">【值班信息】</div>
			<table class="table2" width="100%">
			    <tbody>
					<tr><td class='td-first'>值班时间</td><td class='td-first'>值班经理</td><td class='td-first'>后备值班经理</td></tr>
					<tr><td>{% if duty_date_start and duty_date_end %}{{ duty_date_start }} ~ {{ duty_date_end }}{% else %}{% endif %}</td><td>{{ cur_duty_manager_ch }}</td><td>{{ cur_back_duty_manager_ch }}</td></tr>
			        <tr><td height="10" style="border:none;border-bottom:1px solid #E4E4E4;padding:0cm 0cm 11.0pt 0cm;margin-top:22.5pt"></td></tr>
                </tbody>
			</table>
		</div>
        {% if accidents  %}
            <div class="table1">
                <div class="h3">【事故信息】</div>
                <table class="table1" width="100%">
                    <tbody>
                        <tr>
                            <td class='td-first'>等级</td>
                            <td class='td-first'>描述</td>
                            <td class='td-first'>发生时间</td>
                            <td class='td-first'>解决时间</td>
                            <td class='td-first'>影响范围</td>
                            <td class='td-first'>产生原因</td>
                            <td class='td-first'>责任部门</td>
                            <td class='td-first'>解决过程</td>
                            <td class='td-first'>改进措施</td>
                        </tr>
                        {% for accident in accidents %}
                            <tr>
                                <td class="s" style="color:#000000;">{{ accident.level }}</td>
                                <td>{{ accident.title }}</td>
                                <td>{% if accident.happened_time %} {{ accident.happened_time }} {% else %}{% endif %}</td>
                                <td>{% if accident.finish_time %}{{ accident.finish_time }} {% else %}{% endif %}</td>
                                <td>{{ accident.affect }}</td>
                                <td>{{ accident.reason }}</td>
                                <td>{{ accident.duty_dept_names }}</td>
                                <td>{{ accident.process }}</td>
                                <td>
                                    {% for act in accident.action %}
                                        {{ act.action }}&nbsp;</br>
                                    {% endfor %}
                                </td>
                            </tr>
                        {% endfor %}
                        <tr><td height="10" style="border:none;border-bottom:1px solid #E4E4E4;padding:0cm 0cm 11.0pt 0cm;margin-top:22.5pt"></td></tr>
                    </tbody>
                </table>
            </div>
        {% else %}
            <div class="table2">
                <div class="h3">【事故信息】</div>
                <table class="table2" width="100%">
                    <tbody>
                        <tr><td>祝贺，我们系统很健壮，无事故</td></tr>
                        <tr><td height="10" style="border:none;border-bottom:1px solid #E4E4E4;padding:0cm 0cm 11.0pt 0cm;margin-top:22.5pt"></td></tr>
                    </tbody>
                </table>
            </div>
        {% endif %}

        {% if delay_action %}
            <div class="table3">
                <div class="h3">【延迟Action】</div>
                <table class="table2" width="100%">
                    <tbody>
                        <tr>
                            <td class='td-first'>等级</td>
                            <td class='td-first'>值班经理</td>
                            <td class='td-first'>事故编号</td>
                            <td class='td-first'>事故名称</td>
                            <td class='td-first'>改进措施</td>
                            <td class='td-first'>负责部门</td>
                            <td class='td-first'>负责人</td>
                            <td class='td-first'>预计完成时间</td>
                        </tr>
                        {% for action in delay_action %}
                            <tr>
                                <td>{{ action.level }}</td>
                                <td>{{ action.duty_manager_ch }}</td>
                                <td><a href="http://oms.yihaodian.com.cn/accident/detail/?id={{ action.accidentid }}">{{ action.accidentid }}</a></td>
                                <td>{{ action.title }}</td>
                                <td>{{ action.action }}</td>
                                <td>{{ action.duty_dept }}</td>
                                <td>{{ action.duty_users }}</td>
                                <td>{{ action.expect_time }}</td>
                            </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>

        {% else %}
            <div class="table2">
                <div class="h3">【延迟Action】</div>
                <table class="table2" width="100%">
                    <tbody>
                        <tr><td>无延迟Action</td></tr>
                        <tr><td height="10" style="border:none;border-bottom:1px solid #E4E4E4;padding:0cm 0cm 11.0pt 0cm;margin-top:22.5pt"></td></tr>
                    </tbody>
                </table>
            </div>
        {% endif %}

    <table width="100%" style="border:none;">
        <tbody>
            <tr><td height="10" style="border:none;border-bottom:1px solid #E4E4E4;padding:0cm 0cm 11.0pt 0cm;margin-top:22.5pt"></td></tr>
            <tr><td height="10" style="border:none;"></td></tr>
            <tr><td style="border:none; padding-left:10px; font-weight:bold">相关链接：</td></tr>
            <tr><td style="border:none; padding-left:10px;">1)  <a href="http://oms.yihaodian.com.cn/accident/list/">事故管理系统</a></td></tr>
            <tr><td style="border:none; padding-left:10px;">2)  <a href="http://oms.yihaodian.com.cn/cmdbv2/cmdb/rotaquery/">技术部黄页</a></td></tr>
            <tr><td style="border:none; padding-left:10px;">3)  <a href="http://wiki.yihaodian.cn/mediawiki/images/d/dd/IT-%E6%B5%81%E7%A8%8B-%E9%80%9A%E7%94%A8-1%E5%8F%B7%E5%BA%97%E4%BA%8B%E6%95%85%E5%A4%84%E7%90%86%E6%B5%81%E7%A8%8B.doc">1号店事故处理流程</a></td></tr>
            <tr><td style="border:none; padding-left:10px;">4)  <a href="http://wiki.yihaodian.cn/mediawiki/images/e/e5/IT-%E8%A7%84%E8%8C%83-%E9%80%9A%E7%94%A8-1%E5%8F%B7%E5%BA%97%E7%BA%BF%E4%B8%8A%E4%BA%8B%E6%95%85%E5%A4%84%E7%90%86%E8%A7%84%E8%8C%83.doc">1号店线上事故处理规范</a></td></tr>
            <tr><td style="border:none; padding-left:10px;">5)  <a href="http://wiki.yihaodian.cn/mediawiki/images/b/ba/IT-%E6%B5%81%E7%A8%8B-%E9%80%9A%E7%94%A8-%E6%8A%80%E6%9C%AF%E9%83%A8%E5%80%BC%E7%8F%AD%E7%BB%8F%E7%90%86%E7%AE%A1%E7%90%86%E5%88%B6%E5%BA%A6.doc">技术部值班经理管理制度</a></td></tr>
            <tr><td height="15" style="border:none;padding:0cm 0cm 11.0pt 0cm;padding-left:10px;margin-top:22.5pt"></td></tr>
            <tr><td style="border:none; font-size:14px;padding-left:10px;">Best Regards,</td></tr>
            <tr><td style="border:none; font-size:14px;padding-left:10px;">平台保障部-自动化运维平台</td></tr>
            <tr><td style="border:none; font-size:14px;padding-left:10px;">产品反馈：<a href="mailto:caijiaying@yhd.com" style="font-size:14px; color:#5E9C8D;">蔡佳颖< caijiaying@yhd.com ></a></td></tr>
            <tr><td height="20" style="border:none;padding:0cm 0cm 11.0pt 0cm;padding-left:10px;margin-top:22.5pt"></td></tr>
        </tbody>
    </table>
	</body>
</html>


